---

title: fast.ai helper functions

keywords: fastai
sidebar: home_sidebar

summary: "Useful helper functions from the fast.ai library for processing and visualising structured data."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/01_structured.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="draw_tree" class="doc_header"><code>draw_tree</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>draw_tree</code>(<strong><code>t</code></strong>, <strong><code>df</code></strong>, <strong><code>size</code></strong>=<em><code>10</code></em>, <strong><code>ratio</code></strong>=<em><code>0.6</code></em>, <strong><code>precision</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Draws a representation of a random forest in IPython.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_sample" class="doc_header"><code>get_sample</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_sample</code>(<strong><code>df</code></strong>, <strong><code>n</code></strong>)</p>
</blockquote>
<p>Gets a random sample of n rows from df, without replacement.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_datepart" class="doc_header"><code>add_datepart</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L65" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_datepart</code>(<strong><code>df</code></strong>, <strong><code>fldnames</code></strong>, <strong><code>drop</code></strong>=<em><code>True</code></em>, <strong><code>time</code></strong>=<em><code>False</code></em>, <strong><code>errors</code></strong>=<em><code>'raise'</code></em>)</p>
</blockquote>
<p>add_datepart converts a column of df from a datetime64 to many columns containing
the information from the date. This applies changes inplace.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_date" class="doc_header"><code>is_date</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L86" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_date</code>(<strong><code>x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_cats" class="doc_header"><code>train_cats</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L89" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_cats</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Change any columns of strings in a panda's dataframe to a column of
categorical values. This applies the changes inplace.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="apply_cats" class="doc_header"><code>apply_cats</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L97" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>apply_cats</code>(<strong><code>df</code></strong>, <strong><code>trn</code></strong>)</p>
</blockquote>
<p>Changes any columns of strings in df into categorical variables using trn as
a template for the category codes.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fix_missing" class="doc_header"><code>fix_missing</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L107" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fix_missing</code>(<strong><code>df</code></strong>, <strong><code>col</code></strong>, <strong><code>name</code></strong>, <strong><code>na_dict</code></strong>)</p>
</blockquote>
<p>Fill missing data in a column of df with the median, and add a {name}_na column
which specifies if the data was missing.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="numericalize" class="doc_header"><code>numericalize</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>numericalize</code>(<strong><code>df</code></strong>, <strong><code>col</code></strong>, <strong><code>name</code></strong>, <strong><code>max_n_cat</code></strong>)</p>
</blockquote>
<p>Changes the column col from a categorical type to it's integer codes.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_vars" class="doc_header"><code>scale_vars</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_vars</code>(<strong><code>df</code></strong>, <strong><code>mapper</code></strong>)</p>
</blockquote>
<p>Standardize numerical features by removing the mean and scaling to unit variance.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="proc_df" class="doc_header"><code>proc_df</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>proc_df</code>(<strong><code>df</code></strong>, <strong><code>y_fld</code></strong>=<em><code>None</code></em>, <strong><code>skip_flds</code></strong>=<em><code>None</code></em>, <strong><code>ignore_flds</code></strong>=<em><code>None</code></em>, <strong><code>do_scale</code></strong>=<em><code>False</code></em>, <strong><code>na_dict</code></strong>=<em><code>None</code></em>, <strong><code>preproc_fn</code></strong>=<em><code>None</code></em>, <strong><code>max_n_cat</code></strong>=<em><code>None</code></em>, <strong><code>subset</code></strong>=<em><code>None</code></em>, <strong><code>mapper</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>proc_df takes a data frame df and splits off the response variable, and
changes the df into an entirely numeric dataframe. For each column of df
which is not in skip_flds nor in ignore_flds, na values are replaced by the
median value of the column.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rf_feat_importance" class="doc_header"><code>rf_feat_importance</code><a href="https://github.com/lewtun/dslectures/tree/master/dslectures/structured.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rf_feat_importance</code>(<strong><code>m</code></strong>, <strong><code>df</code></strong>)</p>
</blockquote>
<p>Create a pandas.DataFrame of feature importances.</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

