---

title: Lesson 12 - Natural Language Processing I

keywords: fastai
sidebar: home_sidebar

summary: "Analyse text with machine learning - part 1."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/lesson12-nlp-1.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><p align="left">
{% include image.html max-width="400" file="/dslectures/./images/natural-language-processing-so-hot-right-now.jpg" %}</p>
<p>Natural language processing (NLP) is the part of Machine Learning concerned with the analysis of digital, human written texts. The topic of NLP is as old as machine learning itself and dates back to Alan Turing himself.</p>
<p>However, there has been exciting and rapid progress in the past couple of years. One of the outstanding achievements was the publication of OpenAI's GPT-2, a language model able to not only create realistic text samples but also solve tasks of many NLP benchmarks without special training. See the figure below for an example output of GPT-2.</p>
<p>If you want to try your own examples you can do so at <a href="https://talktotransformer.com/">talktotransformer.com</a> or read the original article on <a href="https://openai.com/blog/better-language-models/">OpenAI's webpage</a>.</p>
<p><p align="left">
{% include image.html max-width="400" file="/dslectures/./images/gpt2-example.png" %}</p>
<p><em>Summary:</em> In this notebook explore how we can transform text into a format that is machine readable by using <strong>vector encodings</strong>. To get high quality encodings it is often necessary to do some <strong>pre-processing</strong> on the raw texts. This often requires some forms of <strong>string processing</strong> which are briefly explained and showcased. Finally, we use the encodings to build a rudimentary <strong>search enginge</strong>. In summary, this lecture is structured in the following three parts:</p>
<ul>
<li>Dataset: 20 Newsgroup</li>
<li>String Processing</li>
<li>Vector Encodings</li>
<li>Search Enginge</li>
</ul>
<p><em>Created by:</em> Leandro von Werra, Spring 2019</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sets how many digits of numpy objects are printed </span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataset">Dataset<a class="anchor-link" href="#Dataset">&#182;</a></h2><p>In this lesson we will use the 20 Newsgroup dataset which is the <code>Hello World</code> example in NLP. It contains about 18'000 text snippets that belong to 20 topics. The goal is to assign the texts in the test set to the 20 topics.</p>
<p>This dataset can be loaded using the <code>Scikit-learn</code> API:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting <code>newsgroups_train</code> variable is a dictionary with several keys:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;data&#39;, &#39;filenames&#39;, &#39;target_names&#39;, &#39;target&#39;, &#39;DESCR&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>DESCR</code> contains a text with a description of the dataset:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;DESCR&#39;</span><span class="p">][</span><span class="mi">25</span><span class="p">:</span><span class="mi">394</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

The 20 newsgroups text dataset
------------------------------

The 20 newsgroups dataset comprises around 18000 newsgroups posts on
20 topics split in two subsets: one for training (or development)
and the other one for testing (or for performance evaluation). The split
between the train and test set is based upon a messages posted before
and after a specific date.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>data</code> entry contains a list of all texts. We can print the first entry:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From: Mamatha Devineni Ratnam &lt;mr47+@andrew.cmu.edu&gt;
Subject: Pens fans reactions
Organization: Post Office, Carnegie Mellon, Pittsburgh, PA
Lines: 12
NNTP-Posting-Host: po4.andrew.cmu.edu



I am sure some bashers of Pens fans are pretty confused about the lack
of any kind of posts about the recent Pens massacre of the Devils. Actually,
I am  bit puzzled too and a bit relieved. However, I am going to put an end
to non-PIttsburghers&#39; relief with a bit of praise for the Pens. Man, they
are killing those Devils worse than I thought. Jagr just showed you why
he is much better than his regular season stats. He is also a lot
fo fun to watch in the playoffs. Bowman should let JAgr have a lot of
fun in the next couple of games since the Pens are going to beat the pulp out of Jersey anyway. I was very disappointed not to see the Islanders lose the final
regular season game.          PENS RULE!!!


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>target</code> contains the numerical lables wheras the <code>target_names</code> contains the text labels as the name suggests. The label that belongs to the example above is:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;alt.atheism&#39;,
 &#39;comp.graphics&#39;,
 &#39;comp.os.ms-windows.misc&#39;,
 &#39;comp.sys.ibm.pc.hardware&#39;,
 &#39;comp.sys.mac.hardware&#39;,
 &#39;comp.windows.x&#39;,
 &#39;misc.forsale&#39;,
 &#39;rec.autos&#39;,
 &#39;rec.motorcycles&#39;,
 &#39;rec.sport.baseball&#39;,
 &#39;rec.sport.hockey&#39;,
 &#39;sci.crypt&#39;,
 &#39;sci.electronics&#39;,
 &#39;sci.med&#39;,
 &#39;sci.space&#39;,
 &#39;soc.religion.christian&#39;,
 &#39;talk.politics.guns&#39;,
 &#39;talk.politics.mideast&#39;,
 &#39;talk.politics.misc&#39;,
 &#39;talk.religion.misc&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the example text this means it belongs to the following category:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">][</span><span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;rec.sport.hockey&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we store the data in a DataFrame, since it is easier to handle the data once it is in that form.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;filenames&#39;</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;filenames&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filenames</th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/Users/leandro/scikit_learn_data/20news_home/2...</td>
      <td>From: Mamatha Devineni Ratnam &lt;mr47+@andrew.cm...</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/Users/leandro/scikit_learn_data/20news_home/2...</td>
      <td>From: mblawson@midway.ecn.uoknor.edu (Matthew ...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/Users/leandro/scikit_learn_data/20news_home/2...</td>
      <td>From: hilmi-er@dsv.su.se (Hilmi Eren)\nSubject...</td>
      <td>17</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/Users/leandro/scikit_learn_data/20news_home/2...</td>
      <td>From: guyd@austin.ibm.com (Guy Dawson)\nSubjec...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/Users/leandro/scikit_learn_data/20news_home/2...</td>
      <td>From: Alexander Samuel McDiarmid &lt;am2o+@andrew...</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also do a few necessary dataframe operations:</p>
<ol>
<li>Remove the filepath from the filename by taking the piece after last slash.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;filenames&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;filenames&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Split off additional information from text such as email adresses.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Add the target names to the entries in the dataframe</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filenames</th>
      <th>text</th>
      <th>target</th>
      <th>target_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>54367</td>
      <td>\n\nI am sure some bashers of Pens fans are pr...</td>
      <td>10</td>
      <td>rec.sport.hockey</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60215</td>
      <td>My brother is in the market for a high-perfo...</td>
      <td>3</td>
      <td>comp.sys.ibm.pc.hardware</td>
    </tr>
    <tr>
      <th>2</th>
      <td>76120</td>
      <td>\n\n\n|&gt;The student of "regional killings" ali...</td>
      <td>17</td>
      <td>talk.politics.mideast</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60771</td>
      <td>\nIn article &lt;1993Apr19.034517.12820@julian.uw...</td>
      <td>3</td>
      <td>comp.sys.ibm.pc.hardware</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51882</td>
      <td>\n1)    I have an old Jasmine drive which I c...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Exercise 1:</strong> Create a new column called <code>text_length</code> where the length of each text is stored and then  plot a histogram of the text lenghts.</p>
<ul>
<li>To get the new columne use the <code>apply</code> and the function <code>len</code> to get the length of the a string. Example usage of <code>len</code>:<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span>
</pre></div>
</li>
<li>Then use the <code>sns.distplot</code> function to plot the distribution. Set the bins argument of displot to <code>bins=1000</code> and then use <code>plt.xlim([0,1000])</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="String-Processing">String Processing<a class="anchor-link" href="#String-Processing">&#182;</a></h2><p>In this section we have a look at the basics of string processing. Being able to filter/combine/manipulate strings is a crucial skill to do natural language processing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;This is a string!</span><span class="se">\n</span><span class="s1">(But not a very interesting one)</span><span class="se">\n\n\t</span><span class="s1">End.&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>This is a string!
(But not a very interesting one)

	End.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In Python strings are lists of characters and as such one can iterate through them like lists:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">character</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>T
h
i
s
 
i
s
 
a
 
s
t
r
i
n
g
!


(
B
u
t
 
n
o
t
 
a
 
v
e
r
y
 
i
n
t
e
r
e
s
t
i
n
g
 
o
n
e
)




	
E
n
d
.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check their length like lists:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>57</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check if they contain certain elements like lists:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;!&#39;</span> <span class="ow">in</span> <span class="n">string</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also check if a <strong>substring</strong> is present in a string:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;very&#39;</span> <span class="ow">in</span> <span class="n">string</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Capitalisation:</strong>
There are different ways to manipulate the casing of strings:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;TEST&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;TEST&#39;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;test&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;test&#39;</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;Test&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Adding strings:</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="o">+</span><span class="s1">&#39;b&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ab
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Splitting strings:</strong></p>
<p>Often we need to split sentences into words or file paths into components. For this task we can use the <code>split()</code> function. By default a string is split wherever a whitespace is (this could be normal space, a tab <code>\t</code> or a newline <code>\n</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;This&#39;,
 &#39;is&#39;,
 &#39;a&#39;,
 &#39;string!&#39;,
 &#39;(But&#39;,
 &#39;not&#39;,
 &#39;a&#39;,
 &#39;very&#39;,
 &#39;interesting&#39;,
 &#39;one)&#39;,
 &#39;End.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;path/to/file/image.jpg&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;path&#39;, &#39;to&#39;, &#39;file&#39;, &#39;image.jpg&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Stripping strings:</strong></p>
<p>Sometimes strings contain leading or trailing characters that we want to get rid of, such as whitespaces or unnecessary characters. We can remove them with the <code>strip()</code> function. Like the <code>split()</code> function it removes whitespaces by default but we can set any characters we want:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;_path/to/file/image.jpg_&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;path/to/file/image.jpg&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;_-_path/to/file/image.jpg,_,&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,_-&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;path/to/file/image.jpg&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Replacing:</strong></p>
<p>With the <code>replace()</code> function one can replace substrings in a string.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;one plus one equals two!&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;one plus one equals three!&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Joining strings</strong></p>
<p>Sometimes we split strings into a list of words for processing (like stemming or stop word removal) and then want to join them back to a single string. To to this we can use the <code>join()</code> function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;words&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;this is a list of words&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;words&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;this-is-a-list-of-words&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Exercise 2:</strong> Write a function that performs the following on <code>string_1</code></p>
<ul>
<li>split the string into words with spaces</li>
<li>then strip the special character <code>/</code> from each word</li>
<li>join the words back together with single spaces (<code>' '</code>)</li>
<li>make the whole string lower-case</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string_1</span> <span class="o">=</span> <span class="s1">&#39;This is a string!</span><span class="se">\n</span><span class="s1">/(But not a very interesting one)/</span><span class="se">\n\n\t</span><span class="s1">End.&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string_1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>This is a string!
/(But not a very interesting one)/

	End.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-processing">Pre-processing<a class="anchor-link" href="#Pre-processing">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we are armed with this arsenal of string processing tools, we can pre-process the texts in the dataset to bring them to a cleaner form.</p>
<p>One of the richest Python libraries to process texts is the Natural Language Toolkit (NLTK). To install it run the follwing command in your environment:</p>
<div class="highlight"><pre><span></span>&gt; pip install nltk
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.stem.snowball</span> <span class="kn">import</span> <span class="n">SnowballStemmer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we go through the following steps to clean-up the texts:</p>
<ul>
<li>Normalization</li>
<li>Tokenization</li>
<li>Remove Stop-Words</li>
<li>Remove Non-Alphabetical Tokens</li>
<li>Stemming</li>
</ul>
<p>We'll do this on one text as an example and then build a function and apply it to all texts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

I am sure some bashers of Pens fans are pretty confused about the lack
of any kind of posts about the recent Pens massacre of the Devils. Actually,
I am  bit puzzled too and a bit relieved. However, I am going to put an end
to non-PIttsburghers&#39; relief with a bit of praise for the Pens. Man, they
are killing those Devils worse than I thought. Jagr just showed you why
he is much better than his regular season stats. He is also a lot
fo fun to watch in the playoffs. Bowman should let JAgr have a lot of
fun in the next couple of games since the Pens are going to beat the pulp out of Jersey anyway. I was very disappointed not to see the Islanders lose the final
regular season game.          PENS RULE!!!


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Normalize">Normalize<a class="anchor-link" href="#Normalize">&#182;</a></h3><p>This is the process of transforming the text to lower-case.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

i am sure some bashers of pens fans are pretty confused about the lack
of any kind of posts about the recent pens massacre of the devils. actually,
i am  bit puzzled too and a bit relieved. however, i am going to put an end
to non-pittsburghers&#39; relief with a bit of praise for the pens. man, they
are killing those devils worse than i thought. jagr just showed you why
he is much better than his regular season stats. he is also a lot
fo fun to watch in the playoffs. bowman should let jagr have a lot of
fun in the next couple of games since the pens are going to beat the pulp out of jersey anyway. i was very disappointed not to see the islanders lose the final
regular season game.          pens rule!!!


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tokenize">Tokenize<a class="anchor-link" href="#Tokenize">&#182;</a></h3><p>Now we split the text in words/tokens.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;i&#39;, &#39;am&#39;, &#39;sure&#39;, &#39;some&#39;, &#39;bashers&#39;, &#39;of&#39;, &#39;pens&#39;, &#39;fans&#39;, &#39;are&#39;, &#39;pretty&#39;, &#39;confused&#39;, &#39;about&#39;, &#39;the&#39;, &#39;lack&#39;, &#39;of&#39;, &#39;any&#39;, &#39;kind&#39;, &#39;of&#39;, &#39;posts&#39;, &#39;about&#39;, &#39;the&#39;, &#39;recent&#39;, &#39;pens&#39;, &#39;massacre&#39;, &#39;of&#39;, &#39;the&#39;, &#39;devils&#39;, &#39;.&#39;, &#39;actually&#39;, &#39;,&#39;, &#39;i&#39;, &#39;am&#39;, &#39;bit&#39;, &#39;puzzled&#39;, &#39;too&#39;, &#39;and&#39;, &#39;a&#39;, &#39;bit&#39;, &#39;relieved&#39;, &#39;.&#39;, &#39;however&#39;, &#39;,&#39;, &#39;i&#39;, &#39;am&#39;, &#39;going&#39;, &#39;to&#39;, &#39;put&#39;, &#39;an&#39;, &#39;end&#39;, &#39;to&#39;, &#39;non-pittsburghers&#39;, &#34;&#39;&#34;, &#39;relief&#39;, &#39;with&#39;, &#39;a&#39;, &#39;bit&#39;, &#39;of&#39;, &#39;praise&#39;, &#39;for&#39;, &#39;the&#39;, &#39;pens&#39;, &#39;.&#39;, &#39;man&#39;, &#39;,&#39;, &#39;they&#39;, &#39;are&#39;, &#39;killing&#39;, &#39;those&#39;, &#39;devils&#39;, &#39;worse&#39;, &#39;than&#39;, &#39;i&#39;, &#39;thought&#39;, &#39;.&#39;, &#39;jagr&#39;, &#39;just&#39;, &#39;showed&#39;, &#39;you&#39;, &#39;why&#39;, &#39;he&#39;, &#39;is&#39;, &#39;much&#39;, &#39;better&#39;, &#39;than&#39;, &#39;his&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;stats&#39;, &#39;.&#39;, &#39;he&#39;, &#39;is&#39;, &#39;also&#39;, &#39;a&#39;, &#39;lot&#39;, &#39;fo&#39;, &#39;fun&#39;, &#39;to&#39;, &#39;watch&#39;, &#39;in&#39;, &#39;the&#39;, &#39;playoffs&#39;, &#39;.&#39;, &#39;bowman&#39;, &#39;should&#39;, &#39;let&#39;, &#39;jagr&#39;, &#39;have&#39;, &#39;a&#39;, &#39;lot&#39;, &#39;of&#39;, &#39;fun&#39;, &#39;in&#39;, &#39;the&#39;, &#39;next&#39;, &#39;couple&#39;, &#39;of&#39;, &#39;games&#39;, &#39;since&#39;, &#39;the&#39;, &#39;pens&#39;, &#39;are&#39;, &#39;going&#39;, &#39;to&#39;, &#39;beat&#39;, &#39;the&#39;, &#39;pulp&#39;, &#39;out&#39;, &#39;of&#39;, &#39;jersey&#39;, &#39;anyway&#39;, &#39;.&#39;, &#39;i&#39;, &#39;was&#39;, &#39;very&#39;, &#39;disappointed&#39;, &#39;not&#39;, &#39;to&#39;, &#39;see&#39;, &#39;the&#39;, &#39;islanders&#39;, &#39;lose&#39;, &#39;the&#39;, &#39;final&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;game&#39;, &#39;.&#39;, &#39;pens&#39;, &#39;rule&#39;, &#39;!&#39;, &#39;!&#39;, &#39;!&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stop-Words">Stop Words<a class="anchor-link" href="#Stop-Words">&#182;</a></h3><p>Next, we remove words that are too common and don't add the the content of sentences. These words are commonly called 'stop words'. NLTK provides a list of stop words:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stop_words</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;will&#39;, &#39;itself&#39;, &#39;them&#39;, &#39;all&#39;, &#39;aren&#39;, &#34;weren&#39;t&#34;, &#39;than&#39;, &#39;this&#39;, &#39;couldn&#39;, &#34;shan&#39;t&#34;, &#34;you&#39;d&#34;, &#39;needn&#39;, &#39;wasn&#39;, &#39;myself&#39;, &#39;again&#39;, &#39;below&#39;, &#39;has&#39;, &#39;at&#39;, &#39;mightn&#39;, &#34;it&#39;s&#34;, &#34;needn&#39;t&#34;, &#34;should&#39;ve&#34;, &#39;while&#39;, &#34;mustn&#39;t&#34;, &#39;ain&#39;, &#39;weren&#39;, &#39;shouldn&#39;, &#39;out&#39;, &#39;doesn&#39;, &#39;won&#39;, &#34;hadn&#39;t&#34;, &#39;hadn&#39;, &#39;you&#39;, &#39;as&#39;, &#39;nor&#39;, &#39;so&#39;, &#39;for&#39;, &#39;once&#39;, &#39;such&#39;, &#39;they&#39;, &#39;my&#39;, &#39;being&#39;, &#34;you&#39;ll&#34;, &#39;with&#39;, &#39;who&#39;, &#39;very&#39;, &#39;few&#39;, &#39;haven&#39;, &#34;won&#39;t&#34;, &#39;ve&#39;, &#39;m&#39;, &#39;of&#39;, &#39;where&#39;, &#39;more&#39;, &#39;down&#39;, &#39;only&#39;, &#39;off&#39;, &#34;mightn&#39;t&#34;, &#39;in&#39;, &#39;above&#39;, &#39;about&#39;, &#39;ll&#39;, &#39;be&#39;, &#39;if&#39;, &#39;over&#39;, &#39;through&#39;, &#39;here&#39;, &#34;doesn&#39;t&#34;, &#39;each&#39;, &#39;mustn&#39;, &#34;hasn&#39;t&#34;, &#34;you&#39;ve&#34;, &#39;don&#39;, &#39;d&#39;, &#39;what&#39;, &#39;am&#39;, &#39;is&#39;, &#39;him&#39;, &#39;that&#39;, &#39;why&#39;, &#39;their&#39;, &#39;should&#39;, &#39;do&#39;, &#39;his&#39;, &#39;she&#39;, &#39;other&#39;, &#39;doing&#39;, &#34;you&#39;re&#34;, &#39;from&#39;, &#39;under&#39;, &#34;wouldn&#39;t&#34;, &#39;an&#39;, &#39;herself&#39;, &#39;most&#39;, &#39;a&#39;, &#34;wasn&#39;t&#34;, &#39;her&#39;, &#39;we&#39;, &#39;ma&#39;, &#39;its&#39;, &#39;before&#39;, &#39;were&#39;, &#39;too&#39;, &#39;o&#39;, &#39;shan&#39;, &#39;wouldn&#39;, &#39;because&#39;, &#39;further&#39;, &#39;by&#39;, &#39;yours&#39;, &#39;after&#39;, &#39;some&#39;, &#39;been&#39;, &#39;s&#39;, &#39;to&#39;, &#39;hasn&#39;, &#39;the&#39;, &#39;then&#39;, &#39;theirs&#39;, &#39;t&#39;, &#39;just&#39;, &#39;those&#39;, &#34;aren&#39;t&#34;, &#39;it&#39;, &#39;had&#39;, &#39;on&#39;, &#34;that&#39;ll&#34;, &#34;didn&#39;t&#34;, &#39;and&#39;, &#39;hers&#39;, &#39;up&#39;, &#39;there&#39;, &#39;ours&#39;, &#34;don&#39;t&#34;, &#39;yourself&#39;, &#39;was&#39;, &#39;or&#39;, &#39;same&#39;, &#39;didn&#39;, &#39;between&#39;, &#39;into&#39;, &#39;your&#39;, &#39;yourselves&#39;, &#39;re&#39;, &#39;y&#39;, &#39;whom&#39;, &#34;couldn&#39;t&#34;, &#39;himself&#39;, &#39;have&#39;, &#39;did&#39;, &#34;isn&#39;t&#34;, &#34;haven&#39;t&#34;, &#39;ourselves&#39;, &#39;until&#39;, &#39;now&#39;, &#39;themselves&#39;, &#39;how&#39;, &#34;shouldn&#39;t&#34;, &#39;i&#39;, &#39;when&#39;, &#39;both&#39;, &#39;can&#39;, &#39;any&#39;, &#39;but&#39;, &#39;during&#39;, &#39;he&#39;, &#34;she&#39;s&#34;, &#39;these&#39;, &#39;having&#39;, &#39;not&#39;, &#39;does&#39;, &#39;our&#39;, &#39;own&#39;, &#39;are&#39;, &#39;no&#39;, &#39;which&#39;, &#39;against&#39;, &#39;me&#39;, &#39;isn&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We keep only the words that are <strong>not</strong> in the list of stop words.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;sure&#39;, &#39;bashers&#39;, &#39;pens&#39;, &#39;fans&#39;, &#39;pretty&#39;, &#39;confused&#39;, &#39;lack&#39;, &#39;kind&#39;, &#39;posts&#39;, &#39;recent&#39;, &#39;pens&#39;, &#39;massacre&#39;, &#39;devils&#39;, &#39;.&#39;, &#39;actually&#39;, &#39;,&#39;, &#39;bit&#39;, &#39;puzzled&#39;, &#39;bit&#39;, &#39;relieved&#39;, &#39;.&#39;, &#39;however&#39;, &#39;,&#39;, &#39;going&#39;, &#39;put&#39;, &#39;end&#39;, &#39;non-pittsburghers&#39;, &#34;&#39;&#34;, &#39;relief&#39;, &#39;bit&#39;, &#39;praise&#39;, &#39;pens&#39;, &#39;.&#39;, &#39;man&#39;, &#39;,&#39;, &#39;killing&#39;, &#39;devils&#39;, &#39;worse&#39;, &#39;thought&#39;, &#39;.&#39;, &#39;jagr&#39;, &#39;showed&#39;, &#39;much&#39;, &#39;better&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;stats&#39;, &#39;.&#39;, &#39;also&#39;, &#39;lot&#39;, &#39;fo&#39;, &#39;fun&#39;, &#39;watch&#39;, &#39;playoffs&#39;, &#39;.&#39;, &#39;bowman&#39;, &#39;let&#39;, &#39;jagr&#39;, &#39;lot&#39;, &#39;fun&#39;, &#39;next&#39;, &#39;couple&#39;, &#39;games&#39;, &#39;since&#39;, &#39;pens&#39;, &#39;going&#39;, &#39;beat&#39;, &#39;pulp&#39;, &#39;jersey&#39;, &#39;anyway&#39;, &#39;.&#39;, &#39;disappointed&#39;, &#39;see&#39;, &#39;islanders&#39;, &#39;lose&#39;, &#39;final&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;game&#39;, &#39;.&#39;, &#39;pens&#39;, &#39;rule&#39;, &#39;!&#39;, &#39;!&#39;, &#39;!&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Punctuation">Punctuation<a class="anchor-link" href="#Punctuation">&#182;</a></h3><p>We also want to get of all tokens that are not composed of letters (e.g. punctuation and numbers). We can check if a words is only composed of alphabetic letters with the <code>isalpha()</code> and filter with it:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;sure&#39;, &#39;bashers&#39;, &#39;pens&#39;, &#39;fans&#39;, &#39;pretty&#39;, &#39;confused&#39;, &#39;lack&#39;, &#39;kind&#39;, &#39;posts&#39;, &#39;recent&#39;, &#39;pens&#39;, &#39;massacre&#39;, &#39;devils&#39;, &#39;actually&#39;, &#39;bit&#39;, &#39;puzzled&#39;, &#39;bit&#39;, &#39;relieved&#39;, &#39;however&#39;, &#39;going&#39;, &#39;put&#39;, &#39;end&#39;, &#39;relief&#39;, &#39;bit&#39;, &#39;praise&#39;, &#39;pens&#39;, &#39;man&#39;, &#39;killing&#39;, &#39;devils&#39;, &#39;worse&#39;, &#39;thought&#39;, &#39;jagr&#39;, &#39;showed&#39;, &#39;much&#39;, &#39;better&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;stats&#39;, &#39;also&#39;, &#39;lot&#39;, &#39;fo&#39;, &#39;fun&#39;, &#39;watch&#39;, &#39;playoffs&#39;, &#39;bowman&#39;, &#39;let&#39;, &#39;jagr&#39;, &#39;lot&#39;, &#39;fun&#39;, &#39;next&#39;, &#39;couple&#39;, &#39;games&#39;, &#39;since&#39;, &#39;pens&#39;, &#39;going&#39;, &#39;beat&#39;, &#39;pulp&#39;, &#39;jersey&#39;, &#39;anyway&#39;, &#39;disappointed&#39;, &#39;see&#39;, &#39;islanders&#39;, &#39;lose&#39;, &#39;final&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;game&#39;, &#39;pens&#39;, &#39;rule&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stemming">Stemming<a class="anchor-link" href="#Stemming">&#182;</a></h3><p>As a final step we want to trim the words to the stem. This helps drastically decrease the vocabulary size and maps similar/same words onto the same word. E.g. plural/singular words or different forms of verbs:</p>
<ul>
<li>pen, pens --&gt; pen</li>
<li>happy, happier --&gt; happi</li>
<li>go, goes --&gt; go</li>
</ul>
<p>There are several languages available in nltk since this is a <strong>language dependant process</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">SnowballStemmer</span><span class="o">.</span><span class="n">languages</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;arabic&#39;, &#39;danish&#39;, &#39;dutch&#39;, &#39;english&#39;, &#39;finnish&#39;, &#39;french&#39;, &#39;german&#39;, &#39;hungarian&#39;, &#39;italian&#39;, &#39;norwegian&#39;, &#39;porter&#39;, &#39;portuguese&#39;, &#39;romanian&#39;, &#39;russian&#39;, &#39;spanish&#39;, &#39;swedish&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applied to the text sample this yields:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stemmer</span> <span class="o">=</span> <span class="n">SnowballStemmer</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;sure&#39;, &#39;basher&#39;, &#39;pen&#39;, &#39;fan&#39;, &#39;pretti&#39;, &#39;confus&#39;, &#39;lack&#39;, &#39;kind&#39;, &#39;post&#39;, &#39;recent&#39;, &#39;pen&#39;, &#39;massacr&#39;, &#39;devil&#39;, &#39;actual&#39;, &#39;bit&#39;, &#39;puzzl&#39;, &#39;bit&#39;, &#39;reliev&#39;, &#39;howev&#39;, &#39;go&#39;, &#39;put&#39;, &#39;end&#39;, &#39;relief&#39;, &#39;bit&#39;, &#39;prais&#39;, &#39;pen&#39;, &#39;man&#39;, &#39;kill&#39;, &#39;devil&#39;, &#39;wors&#39;, &#39;thought&#39;, &#39;jagr&#39;, &#39;show&#39;, &#39;much&#39;, &#39;better&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;stat&#39;, &#39;also&#39;, &#39;lot&#39;, &#39;fo&#39;, &#39;fun&#39;, &#39;watch&#39;, &#39;playoff&#39;, &#39;bowman&#39;, &#39;let&#39;, &#39;jagr&#39;, &#39;lot&#39;, &#39;fun&#39;, &#39;next&#39;, &#39;coupl&#39;, &#39;game&#39;, &#39;sinc&#39;, &#39;pen&#39;, &#39;go&#39;, &#39;beat&#39;, &#39;pulp&#39;, &#39;jersey&#39;, &#39;anyway&#39;, &#39;disappoint&#39;, &#39;see&#39;, &#39;island&#39;, &#39;lose&#39;, &#39;final&#39;, &#39;regular&#39;, &#39;season&#39;, &#39;game&#39;, &#39;pen&#39;, &#39;rule&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Exercise 3:</strong> Put all preprocessing steps into a function <code>preprocessing(text)</code> that returns a list of clean tokens like above and apply it to all texts creating a new column <code>processed_text</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applying this function to the whole corpus takes a while (ca. 1min 30s on my machine). Sometimes it is handy to have a progress bar to see how well/fast we are doing. There is a cool library called <code>tqdm</code> which provides easy to use progress bars.</p>
<p>If you want to experiment with it, you can install it with:</p>
<div class="highlight"><pre><span></span>&gt; pip install tqdm
</pre></div>
<p>After importing you need to register it with pandas with <code>tqdm.pandas()</code>. If you then use <code>progress_apply</code> instead of <code>apply</code> you get a progress bar during the computation showing you the progress. If you have problems installing it or don't want to use it, just use the normal <code>apply</code> function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="n">tqdm</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s2">&quot;progress&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;processed_text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>progress: 100%|██████████| 18846/18846 [01:29&lt;00:00, 209.89it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filenames</th>
      <th>text</th>
      <th>target</th>
      <th>target_name</th>
      <th>processed_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>54367</td>
      <td>\n\nI am sure some bashers of Pens fans are pr...</td>
      <td>10</td>
      <td>rec.sport.hockey</td>
      <td>[sure, basher, pen, fan, pretti, confus, lack,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60215</td>
      <td>My brother is in the market for a high-perfo...</td>
      <td>3</td>
      <td>comp.sys.ibm.pc.hardware</td>
      <td>[brother, market, video, card, support, vesa, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>76120</td>
      <td>\n\n\n|&gt;The student of "regional killings" ali...</td>
      <td>17</td>
      <td>talk.politics.mideast</td>
      <td>[student, region, kill, alia, davidian, davidi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60771</td>
      <td>\nIn article &lt;1993Apr19.034517.12820@julian.uw...</td>
      <td>3</td>
      <td>comp.sys.ibm.pc.hardware</td>
      <td>[articl, wlsmith, wayn, smith, write, articl, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51882</td>
      <td>\n1)    I have an old Jasmine drive which I c...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
      <td>[old, jasmin, drive, use, new, system, underst...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Text-Encodings">Text Encodings<a class="anchor-link" href="#Text-Encodings">&#182;</a></h2><p>Now that we cleaned up and tokenized the text corpus we are now ready to encode the texts in vectors. In class we had a look at simple <strong>one-hot encodings</strong> that can be extended to count encodings and <strong>TF-IDF encodings</strong>.</p>
<p>Scikit-learn comes with functions to do both count and TF-IDF encodings on text. The interface is very similar to the classifier just the <code>predict</code> step is replace with <code>transform</code>:</p>
<div class="highlight"><pre><span></span><span class="n">count_vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">your_settings</span><span class="p">)</span>
<span class="n">count_vectorizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">your_dataset</span><span class="p">)</span>
<span class="n">vec</span> <span class="o">=</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;your_text&#39;</span><span class="p">)</span>
</pre></div>
<p>This creates a vectorizer that can transform texts to vectors.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">TfidfVectorizer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The scikit-learn vectorizers come with a set of rudimentary preprocessors and tokenizers by default, but since we have already done these steps we replace the default values with the identity function does nothing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">doc</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also limit the number of words take into account when building the vector. This limits the vector size and cuts off words that occur rarely.</p>
<p><strong>Example:</strong> If you set <code>vocab_size=10000</code> only the 10000 most occurring words are used to build the vector and all rare words are excluded. This means that the encoding vector then has a dimension of 10000.</p>
<p>For now we take all words (<code>vocab_size=None</code>):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_size</span><span class="o">=</span><span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfidf_vec</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">token_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">)</span>
<span class="n">count_vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">token_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test both vectorizers on a small, dummy dataset with <strong>4 documents</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;document&#39;</span><span class="p">,</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;corpus&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;document&#39;</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;second&#39;</span><span class="p">,</span><span class="s1">&#39;document&#39;</span><span class="p">,</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;corpus&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;and&#39;</span><span class="p">,</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;third&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;corpus&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;the&#39;</span><span class="p">,</span><span class="s1">&#39;first&#39;</span><span class="p">,</span><span class="s1">&#39;document&#39;</span><span class="p">,</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="s1">&#39;this&#39;</span><span class="p">,</span><span class="s1">&#39;corpus&#39;</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we fit a count vectorizer to the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_vec</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>CountVectorizer(analyzer=&#39;word&#39;, binary=False, decode_error=&#39;strict&#39;,
        dtype=&lt;class &#39;numpy.int64&#39;&gt;, encoding=&#39;utf-8&#39;, input=&#39;content&#39;,
        lowercase=True, max_df=1.0, max_features=None, min_df=1,
        ngram_range=(1, 1),
        preprocessor=&lt;function identity at 0x116c73400&gt;, stop_words=None,
        strip_accents=None, token_pattern=None,
        tokenizer=&lt;function identity at 0x116c73400&gt;, vocabulary=None)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once the a vectorizer is fitted, we can investigate the vocabulary. It is a dictionary that points each word to the index in the vector it corresponds to. For example the word <code>'this'</code> corresponds to the 10+1 (+1 because we start counting at zero) entry in the vector and the word <code>'and'</code> corresponds to the the first entry.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_vec</span><span class="o">.</span><span class="n">vocabulary_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;this&#39;: 10,
 &#39;is&#39;: 5,
 &#39;the&#39;: 8,
 &#39;first&#39;: 3,
 &#39;document&#39;: 2,
 &#39;in&#39;: 4,
 &#39;corpus&#39;: 1,
 &#39;second&#39;: 7,
 &#39;and&#39;: 0,
 &#39;third&#39;: 9,
 &#39;one&#39;: 6}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can transform the corpus and get a list of vectors in the form of a matrix (each row corresponds to a document vector):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">count_vec</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[0 1 1 1 1 1 0 0 2 0 1]
 [0 1 2 0 1 1 0 1 2 0 1]
 [1 1 0 0 1 1 1 0 1 1 2]
 [0 1 1 1 1 1 0 0 1 0 2]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we now do the same thing with the TF-IDF vectorizer we see that the output looks different:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfidf_vec</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[0.    0.291 0.356 0.44  0.291 0.291 0.    0.    0.583 0.    0.291]
 [0.    0.238 0.582 0.    0.238 0.238 0.    0.456 0.476 0.    0.238]
 [0.439 0.229 0.    0.    0.229 0.229 0.439 0.    0.229 0.439 0.459]
 [0.    0.291 0.356 0.44  0.291 0.291 0.    0.    0.291 0.    0.583]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The shape of the matrix is the same.</li>
<li>Instead of integers (corresponding to counts) we have continous values.</li>
<li>Elements that occur in multilple documents have lower scores than those appearing in fewer.</li>
</ul>
<p>This should just illustrate how count and TF-IDF vectorizer work. Now let's apply this to our dataset and create encodigs with <code>50000</code> words:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_size</span><span class="o">=</span><span class="mi">50000</span>
<span class="n">tfidf_vec</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">token_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">)</span>
<span class="n">count_vec</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="n">identity</span><span class="p">,</span> <span class="n">token_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="n">vocab_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the example above we used the <code>fit</code> and <code>transform</code> function. We can avoid these two steps with the combined function <code>fit_transform</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_tfidf</span> <span class="o">=</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;processed_text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_count</span> <span class="o">=</span> <span class="n">count_vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;processed_text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This yields a vocabulary with <code>50000</code> entries:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">count_vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>50000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the shape of the returned matrix we see that it still has as many rows as the input but now has <code>50000</code> entries per row (the feature vector).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_count</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(18846, 50000)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So we see that the texts were converted into vectors of size 67390. This is the number of unique words in the dataset. This feature space is <strong>significantly larger</strong> than what we saw so far: 67'390 vs. ~10-20 in the titanic dataset. This is one challenging aspect of NLP: very large, yet sparse (most of the entries are zero) input matrix.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Search-Engine">Search Engine<a class="anchor-link" href="#Search-Engine">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use these encodings to build ourselves a rudimentary <strong>search engine</strong>. We will see that the TF-IDF yield much better results than count vectors.</p>
<p>In information retrieval jargon a question or term that is searched in a corpus of documents is called a <code>query</code>. Let define a example query:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;i want to buy a mustang&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We encode the query with both the count and TF-IDF vectorizer. Note that we duplicate the vector <code>n_documents</code> times. This is not really necessary, but makes the comparison of the query vector with the documents easier since they then have both the same shape.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;query tokens:&#39;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="n">n_documents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_count</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">query_vec_count</span> <span class="o">=</span> <span class="n">count_vec</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">tokens</span><span class="p">]</span><span class="o">*</span><span class="n">n_documents</span><span class="p">)</span>
<span class="n">query_vec_tfidf</span> <span class="o">=</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">tokens</span><span class="p">]</span><span class="o">*</span><span class="n">n_documents</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;query and corpus shapes:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">query_vec_tfidf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_count</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>query tokens: [&#39;want&#39;, &#39;buy&#39;, &#39;mustang&#39;]
query and corpus shapes: (18846, 50000) (18846, 50000)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To compare the encodings we use the <code>cosine_similarity</code>, since it is best suited for high-dimensional vectors:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No we usse this to calculate a similarity between each document and the query:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sim_count</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">X_count</span><span class="p">,</span> <span class="n">query_vec_count</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sim_tfidf</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">X_tfidf</span><span class="p">,</span> <span class="n">query_vec_tfidf</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we are almost done, we only need to find the of the similarity array with the highest similarity with <code>np.argmax</code> and display the <code>text</code> in the dataframe at this position. We can display the best search result for both encodings:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sim_count</span><span class="p">),</span> <span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>I&#39;m looking to buy a &#39;92 Toyota Previa All-Trac with low miles.
If you are selling one, or want someone to buy out an existing lease,
please contact me by mail.

-- 
Will Estes		Internet: westes@netcom.com

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sim_tfidf</span><span class="p">),</span> <span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>petebre@elof.iit.edu (BrentA. Peterson) writes:
&gt;jmh@hopper.Virginia.EDU (Jeffrey Hoffmeister) writes:
&gt;&gt;jmm4h@Virginia.EDU (&#34;The Bald Runner&#34;) writes:

&gt;&gt;&gt;I just have got to remind all of you that this is it!  Yes,
&gt;&gt;&gt;that&#39;s right, somtime this fall, Ford (the granddaddy of cars)
&gt;&gt;&gt;will be introducing an all-new, mega-cool
&gt;&gt;&gt;way-too-fast-for-Accord-drivers Mustang.  It&#39;s supposed to be
&gt;&gt;&gt;100% streamlined, looking similar to the Mach III concept car
&gt;&gt;&gt;Ford came out with around January.  I can&#39;t wait.  Anyone out
&gt;&gt;&gt;there hear anything about it recently?

&gt;&gt;If everything I&#39;ve read is correct, Ford is doing nothing but &#34;re-
&gt;&gt;skinning&#34; the existing Mustang, with MINOR suspension modifications.
&gt;&gt;And the pictures I&#39;ve seen indicate they didn&#39;t do a very good job
&gt;&gt;of it.
&gt;&gt;The &#34;new&#34; mustang, is nothing but a re-cycle of a 20 year old car.

&gt;gee.... is it 1999 already?
&gt;Yes, it will still be on the fox program chasis, anything that will be differe
&gt;nt on the new car as far as mechanical&#39;s is unknown. The suspension will most
&gt;likely be changed, as well as the drive drain. From what has been printed on
&gt;it, there is no clear idea of what will be done, as some say it will have
&gt;the modular V8 and others the current small block... just have to wait and see
&gt;Also is far as styling goes from what I seen is good, a return to tradition.
&gt;C scoop on the sides and roof line much like a &#39;65 or &#39;66 fastback.

You know, I&#39;m a Ford fan, I must say, so I&#39;m looking forward to the next
Mustang.  I have faith that it will be a fine product, more desireable
than the Camaro is now.  You know, that&#39;s MHO.  

The differences these days between Ford and GM are not so much the quality,
just the philosophy.  It used to be quality _and_ philosophy.  GM is
barely catching up, but they have more room for improvement that
can only be made up in time.  STSs still come off the assembly line
with screwed up paint stripes and poor trunk/door/hood/panel alignments;
it&#39;s those 75 year old plants.  And the latest GM products still come
with the standard equipment RattleDash (tm).  But like I said, they&#39;re
getting better and making the move in the right direction.

They beat Ford to the market with the Camaro/Firebird, but really only
in words.  Production of these vehicles will be limited until the
end of the year, keeping selling prices above MSRP for the most part
since there are so many twitching Camaro fans out there.  I wouldn&#39;t
press Ford to hurry the Mustang since the final wait could be worth it.
Besides, no bow-tie fanatic is gonna buy the Mustang anyway.

I do not put much stock in the mag rags&#39; &#34;inside&#34; information, or even
Ford rep quotes.  The Taurus was pretty much a surprise when it was
finally disclosed in it&#39;s entirety.  &#34;Inside&#34; information had the
Taurus with a V8 and rear-wheel drive at one point.  I wouldn&#39;t look
for a simple re-paneled Mustang, folks; you may be cheating yourself
if you do.  There&#39;s a lot of potential.  Ford hasn&#39;t released a new
car without a 4-wheel IS in 7 years.  The Mustang project has been
brewing for at least 4, right?  A 4-wheel IS could happen.  Those
modular V8&#39;s are out there, too.  In the interest of CAFE and
competition, don&#39;t rule those out, either.   Your ignorant if you do.
And there are so many spy shots and artist renderings out there,
who really knows what it&#39;ll look like?  The Mach III?  Doubt it.
Highly.

The next Mustang will be Ford&#39;s highest profile car.  It attracts
way more attention than the Camaro/Firebird because it&#39;s heritage
is more embedded in the general public.  Don&#39;t lie to yourself and
believe Ford will forfeit that.

I submit that the Mustang will be a success.  Enough to elicit
defensive remarks from some heavy Camaro fans here.  You know,
intelligent, critical spews like, &#34;The Mustang bites, man!&#34;  Some of
you are already beginning.  I predict that the Mustang and Camaro
will be comparable performers, as usual.  I predict that the
differences will be in subjective areas like looks and feel, as usual.
The Camaro is still a huge automobile; the Mustang will retain its
cab-rearward styling and short, pony-car wheelbase.  The Camaro still
reaches out to the fighter pilot, while the Mustang will appeal to
the driver.  The Camaro will still sell to the muscle car set, while
the Mustang will continue to sell to the college-degreed muscle car set.
Both will be more refined (I do think the Camaro is).  There will be
no clear winner.

Unless the Ford gets the 32v, 300hp Romeo.  You don&#39;t seriously believe
that it was designed for the Mark VIII only, do you?

:^)

Regards,

Brian

bqueiser@magnus.acs.ohio-state.edu
------------------------------------------------------------------------
I am the engineer, I can choose K.
------------------------------------------------------------------------
Department of Engineering Mechanics
Ohio State University
Columbus, OH

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Exercise 4:</strong> Can you explain why the count vectorizer chose the first text although it doesn't say anything about <code>'mustang'</code>? Why are longer documents generally penalized with the cosine-similarity score (<em>hint:</em> look at the definition of cosine similarity)?</p>

</div>
</div>
</div>
</div>
 

